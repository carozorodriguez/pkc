<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PROKART CALETENSE | Campeonato Oficial</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;500;700&display=swap" rel="stylesheet">

<style>
:root{--rojo:#e10600;--negro:#111;--gris:#f4f4f4}
*{box-sizing:border-box}
body{margin:0;font-family:'Oswald',Arial;background:var(--gris)}

header{
  background:linear-gradient(rgba(0,0,0,.75), rgba(0,0,0,.75)),
  url("img/23610.jpg") center/cover no-repeat;
  color:#fff;text-align:center;padding:120px 20px;
}
header img{max-width:320px;width:90%}

nav{position:sticky;top:0;background:var(--negro);display:flex;justify-content:center;gap:25px;padding:15px;z-index:10}
nav a{color:#fff;text-decoration:none}
nav a:hover{color:var(--rojo)}

section{max-width:1100px;margin:auto;padding:60px 20px}
h2{border-left:6px solid var(--rojo);padding-left:15px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px}
.card{background:#fff;padding:25px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
.btn{display:inline-block;margin:10px 0 20px;padding:12px 18px;background:var(--rojo);color:#fff;text-decoration:none;border-radius:6px}

/* TABLAS */
table{width:100%;border-collapse:collapse;margin-top:20px}
th,td{padding:12px;border-bottom:1px solid #ddd}
th{background:var(--negro);color:#fff}

#tablaGeneral tbody tr:nth-child(1){background:#ffd70033;font-weight:700}
#tablaGeneral tbody tr:nth-child(2){background:#c0c0c033}
#tablaGeneral tbody tr:nth-child(3){background:#cd7f3233}

#aclaracion{background:#fff;border-top:4px solid var(--rojo);text-align:center}

.institucional{text-align:center;padding:60px 20px;background:#fff}
.logos-federaciones{display:flex;justify-content:center;flex-wrap:wrap;gap:40px}
.logos-federaciones img{height:90px;object-fit:contain;filter:grayscale(100%);transition:.3s}
.logos-federaciones img:hover{filter:grayscale(0%);transform:scale(1.05)}

.footer{background:var(--negro);color:#fff;text-align:center;padding:40px 20px;margin-top:40px}
.sponsors img{height:45px;margin:0 10px}
</style>
</head>

<body>

<header>
  <img src="ProKart.jpg" alt="PROKART CALETENSE">
  <h1>PROKART CALETENSE</h1>
  <p>Temporada Oficial 2026</p>
</header>

<nav>
  <a href="#fechas">Fechas</a>
  <a href="#categorias">Categorías</a>
  <a href="#posiciones">Resultados</a>
  <a href="#inscripcion">Inscripciones</a>
</nav>

<!-- ================= FECHAS ================= -->
<section id="fechas">
<h2>Calendario Oficial 2026</h2>
<div class="grid">
<a href="fecha.html?fecha=Fecha%201" class="card"><h3>Fecha 1 - Apertura</h3><p>8 de Marzo - Pico Truncado</p></a>
<a href="fecha.html?fecha=Fecha%202" class="card"><h3>Fecha 2</h3><p>5 de Abril - Pico Truncado</p></a>
<a href="fecha.html?fecha=Fecha%203" class="card"><h3>Fecha 3 - Doble</h3><p>2 de Mayo - Caleta Olivia</p></a>
<a href="fecha.html?fecha=Fecha%204" class="card"><h3>Fecha 4 - Doble</h3><p>3 de Mayo - Caleta Olivia</p></a>
<a href="fecha.html?fecha=Fecha%205" class="card"><h3>Fecha 5</h3><p>7 de Junio - Caleta Olivia</p></a>
<a href="fecha.html?fecha=Fecha%206" class="card"><h3>Fecha 6</h3><p>2 de Agosto - Las Heras</p></a>
<a href="fecha.html?fecha=Fecha%207" class="card"><h3>Fecha 7 - Doble</h3><p>6 de Septiembre - Puerto Deseado</p></a>
<a href="fecha.html?fecha=Fecha%208" class="card"><h3>Fecha 8 - Doble</h3><p>7 de Septiembre - Puerto Deseado</p></a>
<a href="fecha.html?fecha=Fecha%209" class="card"><h3>Fecha 9</h3><p>4 de Octubre - Las Heras</p></a>
<a href="fecha.html?fecha=Fecha%2010" class="card"><h3>Fecha 10 - Cierre</h3><p>1 de Noviembre - Caleta Olivia</p></a>
</div>
</section>

<!-- ================= CATEGORIAS ================= -->
<section id="categorias">
<h2>Categorías</h2>
<div class="grid">

<div class="card">
<h3>PRE JUNIOR</h3>
<a class="btn" href="reglamentos/Reglamento_PRE_JUNIOR_2026.pdf" target="_blank">Descargar Reglamento</a>
</div>

<div class="card">
<h3>JUNIOR</h3>
<a class="btn" href="reglamentos/Reglamento_JUNIOR_2026.pdf" target="_blank">Descargar Reglamento</a>
</div>

<div class="card">
<h3>110 Cajeros</h3>
<a class="btn" href="reglamentos/Reglamento_110_Cajeros_2026.pdf" target="_blank">Descargar Reglamento</a>
</div>

<div class="card">
<h3>200 Master</h3>
<a class="btn" href="reglamentos/Reglamento_200_Master_2026.pdf" target="_blank">Descargar Reglamento</a>
</div>

<div class="card">
<h3>200 STD</h3>
<a class="btn" href="reglamentos/Reglamento_200_STD_2026.pdf" target="_blank">Descargar Reglamento</a>
</div>

</div>
</section>

<!-- ================= RESULTADOS ================= -->
<section id="posiciones">
<h2>Resultados</h2>
<select id="categoriaSelect"></select>
<select id="fechaSelect"></select>

<table id="tablaResultados">
<thead><tr><th>Puesto</th><th>Piloto</th><th>Puntos</th></tr></thead>
<tbody></tbody>
</table>

<h2>Tabla General</h2>
<table id="tablaGeneral">
<thead><tr><th>Pos</th><th>Piloto</th><th>Total</th></tr></thead>
<tbody></tbody>
</table>
</section>

<!-- ================= INSCRIPCION ================= -->
<section id="inscripcion">
<h2>Inscripciones</h2>
<div class="card">
<a class="btn" href="https://docs.google.com/forms" target="_blank">Formulario Oficial</a>
</div>
</section>

<!-- ================= ACLARACION ================= -->
<section id="aclaracion">
<div style="max-width:900px;margin:auto">
<h3>Nota Aclaratoria</h3>
<p>El ProKart Caletense no se hace responsable de los datos suministrados por la FRAD de Santa Cruz Zona Norte para la confección de los puntajes y estadísticas publicadas en esta aplicación.</p>
</div>
</section>

<!-- ================= INSTITUCIONAL ================= -->
<section class="institucional">
<h2>Instituciones que nos respaldan</h2>
<div class="logos-federaciones">
<img src="img/frad.png" alt="FRAD SCZN">
<img src="img/cda.png" alt="CDA">
<img src="img/aca.png" alt="ACA">
</div>
</section>

<!-- ================= FOOTER ================= -->
<footer class="footer">
<div class="sponsors">
<img src="sponsors/vintage.png" alt="Vintage Motors 4T">
<img src="sponsors/caleta.png" alt="Repuestos Santiago">
<img src="sponsors/dany.png" alt="Dany Kart">
</div>
<p>© 2026 PROKART CALETENSE</p>
</footer>

<script>
const SHEET_RESULTADOS="https://docs.google.com/spreadsheets/d/e/2PACX-1vSGhBGHo7TZ_jtqT0HXBvYaV3g1TYBN5lEfYfq2phY0vvHTEyVkTfrVy6RrotDcqVOxm5C4JX9CdTBp/pub?gid=368482217&single=true&output=csv";
const SHEET_PILOTOS="https://docs.google.com/spreadsheets/d/e/2PACX-1vSGhBGHo7TZ_jtqT0HXBvYaV3g1TYBN5lEfYfq2phY0vvHTEyVkTfrVy6RrotDcqVOxm5C4JX9CdTBp/pub?gid=2063656949&single=true&output=csv";

let datos=[];
let pilotosDB={};

async function cargarDatos(){
const r1=await fetch(SHEET_RESULTADOS);
const t1=await r1.text();
const f1=t1.split("\n").map(f=>f.split(","));
const h1=f1[0];

const iFecha=h1.indexOf("Fecha");
const iCat=h1.indexOf("Categoria");
const iPil=h1.indexOf("Piloto");
const iPts=h1.indexOf("Puntos Obtenidos");
const iNum=h1.indexOf("Numero");

datos=f1.slice(1).map(f=>{
const categoria=f[iCat]?.trim();
const numero=f[iNum]?.trim();
return{
fecha:f[iFecha]?.trim(),
categoria,
piloto:f[iPil]?.trim(),
numero,
puntos:Number(f[iPts])||0,
id:categoria+"_"+numero
}
}).filter(d=>d.fecha&&d.categoria&&d.numero);

const r2=await fetch(SHEET_PILOTOS);
const t2=await r2.text();
const f2=t2.split("\n").map(f=>f.split(","));
const h2=f2[0];

const iID=h2.indexOf("ID");
const iNom=h2.indexOf("Nombre");

f2.slice(1).forEach(f=>{
pilotosDB[f[iID]?.trim()]={nombre:f[iNom]?.trim()};
});

cargarCategorias();
}

function cargarCategorias(){
const cats=[...new Set(datos.map(d=>d.categoria))];
categoriaSelect.innerHTML=cats.map(c=>`<option>${c}</option>`).join("");
cargarFechas();
}

function cargarFechas(){
const cat=categoriaSelect.value;
const fechas=[...new Set(datos.filter(d=>d.categoria===cat).map(d=>d.fecha))];
fechaSelect.innerHTML=fechas.map(f=>`<option>${f}</option>`).join("");
mostrarResultados();
}

function mostrarResultados(){
const cat=categoriaSelect.value;
const fec=fechaSelect.value;

const filtrados=datos.filter(d=>d.categoria===cat&&d.fecha===fec).sort((a,b)=>b.puntos-a.puntos);

document.querySelector("#tablaResultados tbody").innerHTML=filtrados.map((d,i)=>`
<tr>
<td>${i+1}</td>
<td><a href="piloto.html?id=${encodeURIComponent(d.id)}">${pilotosDB[d.id]?.nombre||d.piloto}</a></td>
<td>${d.puntos}</td>
</tr>`).join("");

mostrarGeneral(cat);
}

function mostrarGeneral(cat){
const mapa={};
datos.filter(d=>d.categoria===cat).forEach(d=>{
mapa[d.id]=(mapa[d.id]||0)+d.puntos;
});

const ranking=Object.entries(mapa).sort((a,b)=>b[1]-a[1]);

document.querySelector("#tablaGeneral tbody").innerHTML=ranking.map((d,i)=>`
<tr>
<td>${i+1}</td>
<td><a href="piloto.html?id=${encodeURIComponent(d[0])}">${pilotosDB[d[0]]?.nombre||d[0]}</a></td>
<td>${d[1]}</td>
</tr>`).join("");
}

categoriaSelect.addEventListener('change',cargarFechas);
fechaSelect.addEventListener('change',mostrarResultados);

cargarDatos();
</script>

</body>
</html>
