<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PROKART CALETENSE | Campeonato Oficial</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;500;700&display=swap" rel="stylesheet">

<style>
:root{--rojo:#e10600;--negro:#111;--gris:#f4f4f4}
*{box-sizing:border-box}
body{margin:0;font-family:'Oswald',Arial;background:var(--gris)}
header{
  background:
    linear-gradient(rgba(0,0,0,.75), rgba(0,0,0,.75)),
    url("img/fondo-karting.jpg") center/cover no-repeat;
  color:#fff;text-align:center;padding:120px 20px;
}
header img{max-width:320px;width:90%}
nav{position:sticky;top:0;background:var(--negro);display:flex;justify-content:center;gap:25px;padding:15px;z-index:10}
nav a{color:#fff;text-decoration:none}
nav a:hover{color:var(--rojo)}
section{max-width:1100px;margin:auto;padding:60px 20px}
h2{border-left:6px solid var(--rojo);padding-left:15px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px}
.card{background:#fff;padding:25px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
.btn{display:inline-block;margin:10px 0 20px;padding:12px 18px;background:var(--rojo);color:#fff;text-decoration:none;border-radius:6px}
table{width:100%;border-collapse:collapse;margin-top:20px}
th,td{padding:12px;border-bottom:1px solid #ddd}
th{background:var(--negro);color:#fff}
#tablaGeneral{margin-top:30px;background:#fff;border-radius:10px;overflow:hidden}
#tablaGeneral tbody tr:nth-child(1){background:#ffd70033;font-weight:700}
#tablaGeneral tbody tr:nth-child(2){background:#c0c0c033}
#tablaGeneral tbody tr:nth-child(3){background:#cd7f3233}
#aclaracion{background:#fff;border-top:4px solid var(--rojo);text-align:center}
.institucional{text-align:center;padding:60px 20px;background:#fff}
.logos-federaciones{display:flex;justify-content:center;flex-wrap:wrap;gap:40px}
.logos-federaciones img{height:90px;object-fit:contain;filter:grayscale(100%);transition:.3s}
.logos-federaciones img:hover{filter:grayscale(0%);transform:scale(1.05)}
.footer{background:var(--negro);color:#fff;text-align:center;padding:40px 20px;margin-top:40px}
</style>
</head>

<body>

<header>
  <img src="ProKart.jpg">
  <h1>PROKART CALETENSE</h1>
  <p>Temporada Oficial 2026</p>
</header>

<nav>
  <a href="#fechas">Fechas</a>
  <a href="#categorias">Categorías</a>
  <a href="#posiciones">Resultados</a>
  <a href="campeonato.html">Campeonato</a>
</nav>

<section id="posiciones">
<h2>Resultados Oficiales</h2>

<select id="categoriaSelect"></select>
<select id="fechaSelect"></select>

<table id="tablaResultados">
<thead><tr><th>Puesto</th><th>Piloto</th><th>Puntos</th></tr></thead>
<tbody></tbody>
</table>

<table id="tablaGeneral">
<thead><tr><th>Pos</th><th>Piloto</th><th>Total</th></tr></thead>
<tbody></tbody>
</table>
</section>

<footer class="footer">
<p>© 2026 PROKART CALETENSE</p>
</footer>

<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSGhBGHo7TZ_jtqT0HXBvYaV3g1TYBN5lEfYfq2phY0vvHTEyVkTfrVy6RrotDcqVOxm5C4JX9CdTBp/pub?gid=368482217&single=true&output=csv";

let datos = [];

async function cargarDatos(){
  const res = await fetch(SHEET_URL);
  const text = await res.text();
  const filas = text.split("\n").slice(1);

  datos = filas.map(f=>{
    const c = f.split(",");
    return {
      fecha: c[1]?.trim(),
      categoria: c[2]?.trim(),
      piloto: c[3]?.trim(),
      puntos: parseInt(c[4]) || 0
    }
  });

  cargarCategorias();
}

function cargarCategorias(){
  const categorias = [...new Set(datos.map(d=>d.categoria))];
  const select = document.getElementById("categoriaSelect");
  select.innerHTML = categorias.map(c=>`<option>${c}</option>`).join("");
  select.addEventListener("change", cargarFechas);
  cargarFechas();
}

function cargarFechas(){
  const categoria = document.getElementById("categoriaSelect").value;
  const fechas = [...new Set(datos.filter(d=>d.categoria===categoria).map(d=>d.fecha))];
  const select = document.getElementById("fechaSelect");
  select.innerHTML = fechas.map(f=>`<option>${f}</option>`).join("");
  select.addEventListener("change", mostrarResultados);
  mostrarResultados();
}

function mostrarResultados(){
  const categoria = document.getElementById("categoriaSelect").value;
  const fecha = document.getElementById("fechaSelect").value;

  const filtrados = datos.filter(d=>d.categoria===categoria && d.fecha===fecha)
                          .sort((a,b)=>b.puntos-a.puntos);

  const tbody = document.querySelector("#tablaResultados tbody");
  tbody.innerHTML = "";
  filtrados.forEach((d,i)=>{
    tbody.innerHTML += `
      <tr>
        <td>${i+1}</td>
        <td><a href="piloto.html?piloto=${encodeURIComponent(d.piloto)}&categoria=${encodeURIComponent(d.categoria)}">${d.piloto}</a></td>
        <td>${d.puntos}</td>
      </tr>`;
  });

  mostrarGeneral(categoria);
}

function mostrarGeneral(categoria){
  const acumulado = {};
  datos.filter(d=>d.categoria===categoria)
       .forEach(d=>{
         acumulado[d.piloto]=(acumulado[d.piloto]||0)+d.puntos;
       });

  const ranking = Object.entries(acumulado)
                        .sort((a,b)=>b[1]-a[1]);

  const tbody = document.querySelector("#tablaGeneral tbody");
  tbody.innerHTML = "";

  ranking.forEach((d,i)=>{
    tbody.innerHTML += `
      <tr>
        <td>${i+1}</td>
        <td><a href="piloto.html?piloto=${encodeURIComponent(d[0])}&categoria=${encodeURIComponent(categoria)}">${d[0]}</a></td>
        <td>${d[1]}</td>
      </tr>`;
  });
}

cargarDatos();
</script>

</body>
</html>
