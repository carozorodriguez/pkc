<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PROKART CALETENSE | Campeonato Oficial</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;500;700&display=swap" rel="stylesheet">

<style>
:root{--rojo:#e10600;--negro:#111;--gris:#f4f4f4}
*{box-sizing:border-box}
body{margin:0;font-family:'Oswald',Arial;background:var(--gris)}
header{background:#000;color:#fff;text-align:center;padding:60px 20px}
header img{max-width:320px;width:90%}
nav{position:sticky;top:0;background:var(--negro);display:flex;justify-content:center;gap:25px;padding:15px;z-index:10}
nav a{color:#fff;text-decoration:none}
nav a:hover{color:var(--rojo)}
section{max-width:1100px;margin:auto;padding:60px 20px}
h2{border-left:6px solid var(--rojo);padding-left:15px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px}
.card{background:#fff;padding:25px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
.btn{display:inline-block;margin:10px 0 20px;padding:12px 18px;background:var(--rojo);color:#fff;text-decoration:none;border-radius:6px}
.btn:hover{opacity:.85}
table{width:100%;border-collapse:collapse;margin-top:20px}
th,td{padding:12px;border-bottom:1px solid #ddd}
th{background:var(--negro);color:#fff}
#tablaGeneral{margin-top:30px;background:#fff;border-radius:10px;overflow:hidden}
#tablaGeneral td:nth-child(2){text-align:left;padding-left:20px}
#tablaGeneral tbody tr:nth-child(1){background:#ffd70033;font-weight:700}
#tablaGeneral tbody tr:nth-child(2){background:#c0c0c033}
#tablaGeneral tbody tr:nth-child(3){background:#cd7f3233}
footer{background:var(--negro);color:#fff;text-align:center;padding:30px;margin-top:60px}
</style>
</head>

<body>

<header>
<img src="ProKart.jpg" alt="PROKART CALETENSE">
<h1>PROKART CALETENSE</h1>
<p>Temporada Oficial 2026</p>
</header>

<nav>
<a href="#categorias">Categorías</a>
<a href="#fechas">Fechas</a>
<a href="#posiciones">Resultados</a>
<a href="#inscripcion">Inscripciones</a>
</nav>

<section id="categorias">
<h2>Categorías</h2>

<div class="card"><h3>PRE JUNIOR</h3>
<a class="btn" href="reglamentos/Reglamento_PRE_JUNIOR.pdf" target="_blank">Descargar Reglamento PDF</a>
<h4>Pilotos Rankeados</h4><div class="grid"></div></div>

<div class="card"><h3>JUNIOR</h3>
<a class="btn" href="reglamentos/Reglamento_JUNIOR.pdf" target="_blank">Descargar Reglamento PDF</a>
<h4>Pilotos Rankeados</h4><div class="grid"></div></div>

<div class="card"><h3>110 Cajeros</h3>
<a class="btn" href="reglamentos/Reglamento_110_Cajeros.pdf" target="_blank">Descargar Reglamento PDF</a>
<h4>Pilotos Rankeados</h4><div class="grid"></div></div>

<div class="card"><h3>200 Master</h3>
<a class="btn" href="reglamentos/Reglamento_200_Master.pdf" target="_blank">Descargar Reglamento PDF</a>
<h4>Pilotos Rankeados</h4><div class="grid"></div></div>

<div class="card"><h3>200 STD</h3>
<a class="btn" href="reglamentos/Reglamento_200_STD.pdf" target="_blank">Descargar Reglamento PDF</a>
<h4>Pilotos Rankeados</h4><div class="grid"></div></div>

</section>

<section id="fechas">
<h2>Calendario Oficial 2026</h2>
<div class="grid">
<div class="card"><h3>Fecha 1 Apertura</h3><p>8 de Marzo</p><p>Caleta Olivia</p></div>
<div class="card"><h3>Fecha 2</h3><p>3 de Mayo</p><p>Caleta Olivia</p></div>
<div class="card"><h3>Fecha 3</h3><p>7 de Junio</p><p>Caleta Olivia</p></div>
<div class="card"><h3>Fecha 4</h3><p>2 de Agosto</p><p>Caleta Olivia</p></div>
<div class="card"><h3>Fecha 5 Fecha Doble</h3><p>6 de Septiembre</p><p>Puerto Deseado</p></div>
<div class="card"><h3>Fecha 6</h3><p>4 de Octubre</p><p>Pico Truncado</p></div>
<div class="card"><h3>Fecha 7</h3><p>1 de Noviembre</p><p>Las Heras</p></div>
<div class="card"><h3>Fecha 8 Cierre</h3><p>3 de Diciembre</p><p>Caleta Olivia</p></div>
</div>
</section>

<section id="posiciones">
<h2>Resultados</h2>
<select id="categoriaSelect"></select>
<select id="fechaSelect"></select>

<table id="tablaResultados">
<thead><tr><th>Puesto</th><th>Piloto</th><th>Puntos</th></tr></thead>
<tbody></tbody>
</table>

<table id="tablaGeneral">
<thead><tr><th>Pos</th><th>Piloto</th><th>Total</th></tr></thead>
<tbody></tbody>
</table>
</section>

<section id="inscripcion">
<h2>Inscripciones</h2>
<div class="card">
<a class="btn" href="https://docs.google.com/forms" target="_blank">Ir al Formulario</a>
</div>
</section>

<footer>
© 2026 PROKART CALETENSE
</footer>

<script>

/* ================= SHEET RESULTADOS (FORM B) ================= */

const SHEET_RESULTADOS = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSGhBGHo7TZ_jtqT0HXBvYaV3g1TYBN5lEfYfq2phY0vvHTEyVkTfrVy6RrotDcqVOxm5C4JX9CdTBp/pub?gid=368482217&single=true&output=csv";

const catSel = document.getElementById('categoriaSelect');
const fecSel = document.getElementById('fechaSelect');
let datos = [];

cargarDatos();

async function cargarDatos(){
let r = await fetch(SHEET_RESULTADOS);
let text = await r.text();
const filas = text.trim().split('\n').slice(1);

datos = filas.map(f=>{
const c = f.split(',');
return {
fecha: c[1]?.trim(),       // Columna B
categoria: c[2]?.trim(),   // Columna C
piloto: c[3]?.trim(),      // Columna D
puntos: Number(c[4])||0    // Columna E
};
});

cargarCategorias();
cargarRankingCategorias();
}

/* ================= RESULTADOS ================= */

function cargarCategorias(){
catSel.innerHTML='';
[...new Set(datos.map(d=>d.categoria))].forEach(c=>{
const o=document.createElement('option');
o.value=c;o.textContent=c;
catSel.appendChild(o);
});
catSel.onchange=actualizarVista;
actualizarVista();
}

function actualizarVista(){
const categoria=catSel.value;
const filtrados=datos.filter(d=>d.categoria===categoria);
cargarFechas(filtrados);
cargarGeneral(filtrados);
}

function cargarFechas(datosCat){
fecSel.innerHTML='';
[...new Set(datosCat.map(d=>d.fecha))].forEach(f=>{
const o=document.createElement('option');
o.value=f;o.textContent=f;
fecSel.appendChild(o);
});
fecSel.onchange=()=>filtrarFecha(datosCat);
filtrarFecha(datosCat);
}

function filtrarFecha(datosCat){
const tb=document.querySelector('#tablaResultados tbody');
tb.innerHTML='';
datosCat.filter(d=>d.fecha===fecSel.value)
.sort((a,b)=>b.puntos-a.puntos)
.forEach((d,i)=>{
tb.innerHTML+=`<tr>
<td>${i+1}</td>
<td><a href="piloto.html?piloto=${encodeURIComponent(d.piloto)}&categoria=${encodeURIComponent(d.categoria)}">${d.piloto}</a></td>
<td>${d.puntos}</td>
</tr>`;
});
}

function cargarGeneral(datosCat){
const tb=document.querySelector('#tablaGeneral tbody');
tb.innerHTML='';
const mapa={};
datosCat.forEach(d=>mapa[d.piloto]=(mapa[d.piloto]||0)+d.puntos);
Object.entries(mapa).sort((a,b)=>b[1]-a[1])
.forEach((p,i)=>{
tb.innerHTML+=`<tr>
<td>${i+1}</td>
<td><a href="piloto.html?piloto=${encodeURIComponent(p[0])}&categoria=${encodeURIComponent(catSel.value)}">${p[0]}</a></td>
<td>${p[1]}</td>
</tr>`;
});
}

/* ================= RANKING EN CATEGORIAS ================= */

function cargarRankingCategorias(){
document.querySelectorAll('#categorias .card').forEach(card=>{
const categoria=card.querySelector('h3').textContent;
const grid=card.querySelector('.grid');
grid.innerHTML='';
const datosCat=datos.filter(d=>d.categoria===categoria);
const mapa={};
datosCat.forEach(d=>mapa[d.piloto]=(mapa[d.piloto]||0)+d.puntos);
Object.entries(mapa).sort((a,b)=>b[1]-a[1])
.forEach(([piloto,pts],i)=>{
grid.innerHTML+=`
<div class="card">
<p><strong>#${i+1} ${piloto}</strong><br>${pts} pts</p>
<a href="piloto.html?piloto=${encodeURIComponent(piloto)}&categoria=${encodeURIComponent(categoria)}">Ver ficha</a>
</div>`;
});
});
}

</script>

</body>
</html>
